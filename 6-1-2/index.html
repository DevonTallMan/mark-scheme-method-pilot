<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Mark Scheme Method¬Æ ‚Äî 6.2 Data Formats</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;900&family=Share+Tech+Mono&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --void:#0D1117; --panel:rgba(255,255,255,0.05); --panel-border:rgba(255,255,255,0.08);
    --green:#39FF14; --green-glow:rgba(57,255,20,0.4);
    --gold:#FFD700; --gold-glow:rgba(255,215,0,0.4);
    --accent:#38BDF8; --accent-glow:rgba(56,189,248,0.4);
    --red:#FF3B3B; --amber:#FF9500;
    --text-primary:#E8EDF3; --text-dim:rgba(232,237,243,0.5); --text-ghost:rgba(232,237,243,0.2);
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  body{font-family:'Rajdhani',sans-serif;background:var(--void);color:var(--text-primary);min-height:100vh;overflow-x:hidden;}
  body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(56,189,248,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(56,189,248,0.02) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0;}
  body::after{content:'';position:fixed;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.08) 2px,rgba(0,0,0,0.08) 4px);pointer-events:none;z-index:1;}

  /* TOPBAR */
  .topbar{position:fixed;top:0;left:0;right:0;height:56px;background:rgba(13,17,23,0.92);backdrop-filter:blur(20px);border-bottom:1px solid var(--panel-border);display:flex;align-items:center;justify-content:space-between;padding:0 32px;z-index:100;}
  .logo{font-family:'Orbitron',monospace;font-size:12px;font-weight:700;letter-spacing:3px;color:var(--accent);text-shadow:0 0 20px var(--accent-glow);}
  .logo span{color:var(--green);}
  .module-badge{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--accent);border:1px solid rgba(56,189,248,0.35);border-radius:4px;padding:3px 10px;background:rgba(56,189,248,0.07);}
  .step-dots{display:flex;gap:8px;}
  .step-dot{width:8px;height:8px;border-radius:50%;border:1px solid var(--text-ghost);background:transparent;transition:all 0.3s;}
  .step-dot.done{background:var(--accent);border-color:var(--accent);box-shadow:0 0 8px var(--accent-glow);}
  .step-dot.active{background:var(--green);border-color:var(--green);box-shadow:0 0 8px var(--green-glow);animation:pulse-dot 1.5s ease-in-out infinite;}
  @keyframes pulse-dot{0%,100%{transform:scale(1);}50%{transform:scale(1.3);}}

  /* SCENES */
  .scene{display:none;min-height:100vh;padding:80px 24px 40px;position:relative;z-index:2;animation:scene-in 0.6s ease-out;}
  .scene.active{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;}
  @keyframes scene-in{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
  @keyframes fade-in{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
  .glass{background:var(--panel);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid var(--panel-border);border-radius:16px;}
  .scene-label{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:4px;color:var(--accent);display:block;margin-bottom:10px;}
  .scene-headline{font-family:'Orbitron',monospace;font-size:clamp(20px,3.5vw,30px);font-weight:900;color:var(--text-primary);margin-bottom:28px;}
  .btn-primary{font-family:'Orbitron',monospace;font-size:11px;font-weight:700;letter-spacing:3px;padding:14px 28px;background:rgba(56,189,248,0.1);border:1px solid var(--accent);color:var(--accent);border-radius:6px;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all 0.2s;}
  .btn-primary:hover{background:rgba(56,189,248,0.2);box-shadow:0 0 20px var(--accent-glow);}
  .btn-primary span{pointer-events:none;}
  .btn-ghost{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;padding:10px 20px;background:transparent;border:1px solid var(--panel-border);color:var(--text-dim);border-radius:4px;cursor:pointer;transition:all 0.2s;}
  .btn-ghost:hover{border-color:var(--text-dim);color:var(--text-primary);}
  .btn-row{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:28px;}

  /* SCENE 1 ‚Äî BRIEFING */
  .briefing-container{max-width:900px;width:100%;margin-top:20px;}
  .mission-tag{font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:4px;color:var(--accent);margin-bottom:12px;display:block;animation:fade-in 0.8s ease 0.2s both;}
  .mission-title{font-family:'Orbitron',monospace;font-size:clamp(26px,5vw,46px);font-weight:900;line-height:1.1;color:var(--text-primary);text-align:center;margin-bottom:40px;animation:fade-in 0.8s ease 0.4s both;}
  .mission-title .ac{color:var(--accent);text-shadow:0 0 30px var(--accent-glow);}
  .mission-title .gn{color:var(--green);text-shadow:0 0 30px var(--green-glow);}
  .avatar-briefing{display:grid;grid-template-columns:220px 1fr;gap:32px;align-items:center;animation:fade-in 0.8s ease 0.6s both;}
  @media(max-width:700px){.avatar-briefing{grid-template-columns:1fr;}}
  .avatar-card{padding:24px;text-align:center;position:relative;overflow:hidden;}
  .avatar-card::before{content:'';position:absolute;inset:0;background:radial-gradient(circle at 50% 30%,rgba(56,189,248,0.08),transparent 70%);}
  .avatar-figure{width:120px;height:120px;margin:0 auto 16px;border-radius:50%;border:2px solid var(--accent);box-shadow:0 0 30px var(--accent-glow),inset 0 0 30px rgba(56,189,248,0.1);display:flex;align-items:center;justify-content:center;font-size:60px;background:radial-gradient(circle,rgba(56,189,248,0.12),transparent);animation:avatar-pulse 3s ease-in-out infinite;}
  @keyframes avatar-pulse{0%,100%{box-shadow:0 0 30px var(--accent-glow);}50%{box-shadow:0 0 60px var(--accent-glow);}}
  .avatar-name{font-family:'Orbitron',monospace;font-size:12px;font-weight:700;color:var(--accent);letter-spacing:2px;}
  .avatar-title{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);letter-spacing:1px;margin-top:4px;}
  .briefing-panel{padding:32px;position:relative;}
  .terminal-label{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--accent);letter-spacing:2px;margin-bottom:20px;display:flex;align-items:center;gap:8px;}
  .terminal-label::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--accent);box-shadow:0 0 10px var(--accent-glow);animation:blink 1s step-end infinite;}
  @keyframes blink{0%,100%{opacity:1;}50%{opacity:0;}}
  .briefing-text{font-family:'Share Tech Mono',monospace;font-size:14px;line-height:1.8;color:var(--text-primary);}
  .briefing-text .hl-g{color:var(--green);}
  .briefing-text .hl-ac{color:var(--accent);}
  .briefing-text .hl-r{color:var(--red);}
  .nei-trio{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-top:28px;}
  @media(max-width:600px){.nei-trio{grid-template-columns:1fr;}}
  .nei-card{padding:16px;border-radius:12px;text-align:center;}
  .nei-letter{font-family:'Orbitron',monospace;font-size:28px;font-weight:900;margin-bottom:6px;}
  .nei-label{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;margin-bottom:8px;opacity:0.7;}
  .nei-desc{font-size:13px;color:var(--text-dim);line-height:1.4;}
  .n-card{border:1px solid rgba(255,59,59,0.3);background:rgba(255,59,59,0.05);}
  .n-card .nei-letter{color:var(--red);text-shadow:0 0 20px rgba(255,59,59,0.5);}
  .e-card{border:1px solid rgba(255,149,0,0.3);background:rgba(255,149,0,0.05);}
  .e-card .nei-letter{color:var(--amber);text-shadow:0 0 20px rgba(255,149,0,0.5);}
  .i-card{border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);}
  .i-card .nei-letter{color:var(--green);text-shadow:0 0 20px var(--green-glow);}
  .intel-box{margin-top:24px;padding:16px 20px;background:rgba(56,189,248,0.05);border:1px solid rgba(56,189,248,0.2);border-radius:10px;}
  .intel-box-title{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--accent);margin-bottom:10px;}
  .intel-stat-row{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;text-align:center;}
  .intel-stat-val{font-family:'Orbitron',monospace;font-size:22px;font-weight:900;color:var(--accent);}
  .intel-stat-lbl{font-family:'Share Tech Mono',monospace;font-size:9px;letter-spacing:1px;color:var(--text-dim);margin-top:3px;line-height:1.4;}

  /* SCENE 2 ‚Äî DRAG DROP */
  .dd-container{max-width:900px;width:100%;margin-top:20px;}
  .dd-pool-label{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--text-dim);margin-bottom:14px;}
  .chips-pool{display:flex;gap:10px;flex-wrap:wrap;padding:16px;background:rgba(255,255,255,0.02);border:1px solid var(--panel-border);border-radius:10px;min-height:60px;margin-bottom:28px;}
  .data-chip{font-family:'Rajdhani',sans-serif;font-size:14px;font-weight:600;padding:10px 16px;border:1px solid var(--panel-border);border-radius:8px;background:rgba(255,255,255,0.06);cursor:grab;user-select:none;transition:all 0.2s;}
  .data-chip:hover{border-color:var(--accent);background:rgba(56,189,248,0.08);}
  .data-chip.dragging{opacity:0.4;transform:scale(0.95);}
  .dd-targets{display:flex;flex-direction:column;gap:14px;}
  .drop-zone{padding:16px 20px;border-radius:12px;display:flex;align-items:center;gap:16px;min-height:68px;transition:all 0.25s;}
  .drop-zone.over{border-color:var(--accent);background:rgba(56,189,248,0.08);}
  .drop-zone.correct{border-color:var(--green);background:rgba(57,255,20,0.07);}
  .drop-zone.incorrect{border-color:var(--red);background:rgba(255,59,59,0.07);}
  .dz-badge{font-family:'Orbitron',monospace;font-size:10px;font-weight:700;letter-spacing:2px;padding:6px 12px;border-radius:6px;white-space:nowrap;}
  .dz-label{flex:1;}
  .dz-desc{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);margin-bottom:4px;}
  .dz-answer{font-family:'Share Tech Mono',monospace;font-size:13px;}
  .dz-empty{font-style:italic;opacity:0.4;}
  .dd-feedback{margin-top:20px;padding:16px 20px;border-radius:12px;font-family:'Share Tech Mono',monospace;font-size:13px;display:none;}
  .dd-feedback.show{display:block;animation:fade-in 0.4s ease both;}
  .dd-feedback.success{border:1px solid var(--green);background:rgba(57,255,20,0.07);color:var(--green);}
  .dd-feedback.error{border:1px solid var(--red);background:rgba(255,59,59,0.07);color:var(--red);}

  /* SCENE 3 ‚Äî TERMINAL */
  .mission-layout{max-width:1000px;width:100%;display:grid;grid-template-columns:1fr 220px;gap:24px;margin-top:20px;align-items:flex-start;}
  @media(max-width:750px){.mission-layout{grid-template-columns:1fr;}}
  .terminal-panel{padding:0;overflow:hidden;}
  .terminal-header{display:flex;align-items:center;gap:8px;padding:14px 20px;background:rgba(56,189,248,0.04);border-bottom:1px solid var(--panel-border);}
  .terminal-dots{display:flex;gap:6px;}
  .tdot{width:10px;height:10px;border-radius:50%;}
  .tdot.r{background:#ff5f56;} .tdot.y{background:#ffbd2e;} .tdot.b{background:var(--accent);}
  .terminal-path{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);margin-left:8px;}
  .question-block{padding:24px;border-bottom:1px solid var(--panel-border);}
  .q-tag{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--accent);margin-bottom:10px;}
  .q-text{font-family:'Rajdhani',sans-serif;font-size:16px;font-weight:600;line-height:1.6;color:var(--text-primary);}
  .q-marks{display:inline-block;font-family:'Orbitron',monospace;font-size:11px;color:var(--accent);border:1px solid rgba(56,189,248,0.4);border-radius:4px;padding:2px 8px;margin-left:8px;}
  .answer-area{padding:20px;}
  .answer-textarea{width:100%;min-height:160px;background:rgba(56,189,248,0.02);border:1px solid rgba(56,189,248,0.15);border-radius:8px;color:var(--text-primary);font-family:'Rajdhani',sans-serif;font-size:16px;font-weight:500;line-height:1.7;padding:16px;resize:vertical;outline:none;transition:border-color 0.2s;}
  .answer-textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(56,189,248,0.06);}
  .answer-textarea::placeholder{color:var(--text-ghost);}
  .char-count{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);text-align:right;margin-top:8px;}
  .method-ribbon{padding:24px 16px;display:flex;flex-direction:column;gap:16px;position:sticky;top:80px;}
  .ribbon-title{font-family:'Orbitron',monospace;font-size:11px;font-weight:700;letter-spacing:3px;color:var(--text-dim);text-align:center;}
  .nei-hud-item{padding:16px 12px;border-radius:10px;text-align:center;border:1px solid;transition:all 0.4s;opacity:0.35;}
  .nei-hud-item.active-n{opacity:1;border-color:rgba(255,59,59,0.5);background:rgba(255,59,59,0.08);}
  .nei-hud-item.active-e{opacity:1;border-color:rgba(255,149,0,0.5);background:rgba(255,149,0,0.08);}
  .nei-hud-item.active-i{opacity:1;border-color:rgba(57,255,20,0.5);background:rgba(57,255,20,0.08);}
  .hud-letter{font-family:'Orbitron',monospace;font-size:24px;font-weight:900;display:block;margin-bottom:4px;}
  .hud-n{border-color:rgba(255,59,59,0.2);} .hud-n .hud-letter{color:var(--red);}
  .hud-e{border-color:rgba(255,149,0,0.2);} .hud-e .hud-letter{color:var(--amber);}
  .hud-i{border-color:rgba(57,255,20,0.2);} .hud-i .hud-letter{color:var(--green);}
  .hud-label{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--text-dim);margin-bottom:6px;}
  .hud-hint{font-size:12px;color:var(--text-dim);line-height:1.4;}
  @keyframes hud-glitch{0%{filter:invert(0) brightness(1)}20%{filter:invert(1) brightness(2)}40%{filter:invert(0) brightness(1)}60%{filter:invert(1) brightness(2)}80%{filter:invert(0) brightness(1)}100%{filter:invert(0) brightness(1)}}
  @keyframes impact-pulse{0%,100%{box-shadow:0 0 0 rgba(57,255,20,0)}50%{box-shadow:0 0 14px rgba(57,255,20,0.5)}}
  .energy-bar-wrap{display:flex;align-items:center;gap:10px;margin-top:10px;}
  .energy-bar-track{flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;border:1px solid rgba(255,255,255,0.08);}
  .energy-bar-fill{height:100%;width:0%;border-radius:4px;transition:width 0.3s ease,background 0.4s ease;}
  .energy-bar-fill.eb-red{background:var(--red);}
  .energy-bar-fill.eb-amber{background:var(--amber);animation:bar-pulse 1.2s ease infinite;}
  .energy-bar-fill.eb-green{background:var(--green);animation:bar-flash 0.6s ease forwards;}
  @keyframes bar-pulse{0%,100%{opacity:1}50%{opacity:0.55}}
  @keyframes bar-flash{0%{box-shadow:none}50%{box-shadow:0 0 18px rgba(57,255,20,0.7)}100%{box-shadow:0 0 10px rgba(57,255,20,0.4)}}
  .energy-bar-label{font-family:'Share Tech Mono',monospace;font-size:11px;min-width:160px;transition:color 0.4s;}

  /* SCENE 4 ‚Äî CALIBRATION */
  .calibration-layout{max-width:960px;width:100%;margin-top:20px;display:grid;grid-template-columns:1fr 280px;gap:24px;align-items:flex-start;}
  @media(max-width:800px){.calibration-layout{grid-template-columns:1fr;}}
  .cal-main{display:flex;flex-direction:column;gap:20px;}
  .model-answer-panel{padding:24px;}
  .ma-title{font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:3px;color:var(--accent);margin-bottom:16px;}
  .ma-text{font-size:15px;line-height:1.8;font-weight:500;}
  .ma-n{background:rgba(255,59,59,0.25);color:#ffaaaa;border-radius:3px;padding:1px 4px;}
  .ma-e{background:rgba(255,149,0,0.25);color:#ffcc88;border-radius:3px;padding:1px 4px;}
  .ma-i{background:rgba(57,255,20,0.2);color:#aaff88;border-radius:3px;padding:1px 4px;}
  .ma-legend{display:flex;gap:16px;margin-top:16px;flex-wrap:wrap;}
  .legend-item{display:flex;align-items:center;gap:6px;font-family:'Share Tech Mono',monospace;font-size:11px;}
  .legend-dot{width:10px;height:10px;border-radius:2px;}
  .highlight-toolbar{padding:20px;position:sticky;top:80px;}
  .toolbar-title{font-family:'Orbitron',monospace;font-size:11px;letter-spacing:2px;color:var(--text-dim);margin-bottom:20px;text-align:center;}
  .hl-btn{width:100%;padding:14px 16px;border-radius:10px;border:1px solid;background:transparent;cursor:pointer;font-family:'Orbitron',monospace;font-size:12px;font-weight:700;letter-spacing:2px;display:flex;align-items:center;gap:10px;transition:all 0.2s;margin-bottom:10px;}
  .hl-btn.active{transform:translateX(4px);}
  .hl-n{border-color:rgba(255,59,59,0.4);color:var(--red);} .hl-n:hover,.hl-n.active{background:rgba(255,59,59,0.15);border-color:var(--red);}
  .hl-e{border-color:rgba(255,149,0,0.4);color:var(--amber);} .hl-e:hover,.hl-e.active{background:rgba(255,149,0,0.15);border-color:var(--amber);}
  .hl-i{border-color:rgba(57,255,20,0.4);color:var(--green);} .hl-i:hover,.hl-i.active{background:rgba(57,255,20,0.15);border-color:var(--green);}
  .hl-instructions{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);line-height:1.6;margin-top:16px;padding-top:16px;border-top:1px solid var(--panel-border);}
  .student-answer-area{padding:24px;}
  .sa-title{font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:3px;color:var(--text-dim);margin-bottom:16px;}
  #student-display{font-size:16px;line-height:1.9;font-weight:500;cursor:text;min-height:80px;}
  #student-display .hl-n-tag{background:rgba(255,59,59,0.3);color:#ffcccc;border-radius:3px;padding:0 3px;}
  #student-display .hl-e-tag{background:rgba(255,149,0,0.3);color:#ffe0aa;border-radius:3px;padding:0 3px;}
  #student-display .hl-i-tag{background:rgba(57,255,20,0.25);color:#bbffaa;border-radius:3px;padding:0 3px;}
  .vulnerability-alert{display:none;padding:20px 24px;border:1px solid var(--red);background:rgba(255,59,59,0.08);border-radius:12px;animation:vuln-in 0.5s ease both;}
  .vulnerability-alert.show{display:block;}
  @keyframes vuln-in{from{transform:scale(0.95);opacity:0;}to{transform:scale(1);opacity:1;}}
  .vuln-header{display:flex;align-items:center;gap:10px;font-family:'Orbitron',monospace;font-size:13px;font-weight:700;color:var(--red);margin-bottom:12px;}
  .vuln-icon{width:32px;height:32px;border-radius:50%;background:rgba(255,59,59,0.2);border:1px solid var(--red);display:flex;align-items:center;justify-content:center;font-size:16px;animation:pulse-red 1s ease-in-out infinite;}
  @keyframes pulse-red{0%,100%{box-shadow:0 0 0 0 rgba(255,59,59,0.4);}50%{box-shadow:0 0 0 8px rgba(255,59,59,0);}}
  .vuln-msg{font-family:'Share Tech Mono',monospace;font-size:13px;color:var(--text-primary);line-height:1.7;}
  .vuln-msg strong{color:var(--red);}
  .success-alert{display:none;padding:20px 24px;border:1px solid var(--green);background:rgba(57,255,20,0.07);border-radius:12px;animation:fade-in 0.5s ease both;}
  .success-alert.show{display:block;}
  .success-header{display:flex;align-items:center;gap:10px;font-family:'Orbitron',monospace;font-size:13px;font-weight:700;color:var(--green);margin-bottom:12px;}
  .nei-tally{display:flex;gap:12px;margin-top:12px;flex-wrap:wrap;}
  .tally-chip{font-family:'Share Tech Mono',monospace;font-size:12px;padding:6px 14px;border-radius:20px;border:1px solid;}
  .tally-n{border-color:var(--red);background:rgba(255,59,59,0.1);color:#ff8888;}
  .tally-e{border-color:var(--amber);background:rgba(255,149,0,0.1);color:#ffcc88;}
  .tally-i{border-color:var(--green);background:rgba(57,255,20,0.1);color:#aaff88;}

  /* SCENE 5 ‚Äî SUCCESS */
  .success-scene{max-width:700px;width:100%;margin-top:20px;display:flex;flex-direction:column;align-items:center;gap:32px;}
  .badge-3d{width:200px;height:200px;border-radius:50%;background:conic-gradient(var(--accent),var(--green),var(--amber),var(--accent),var(--green),var(--accent));display:flex;align-items:center;justify-content:center;animation:badge-spin 8s linear infinite,badge-float 3s ease-in-out infinite;box-shadow:0 0 60px var(--accent-glow),0 0 120px rgba(57,255,20,0.2);cursor:pointer;margin:0 auto;}
  @keyframes badge-spin{from{filter:hue-rotate(0deg);}to{filter:hue-rotate(360deg);}}
  @keyframes badge-float{0%,100%{transform:translateY(0) rotate(0deg);}50%{transform:translateY(-12px) rotate(3deg);}}
  .badge-inner{width:170px;height:170px;border-radius:50%;background:radial-gradient(circle,#1a2030,var(--void));display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:20px;box-shadow:inset 0 0 40px rgba(0,0,0,0.5);}
  .badge-icon{font-size:48px;margin-bottom:8px;}
  .badge-rank{font-family:'Orbitron',monospace;font-size:8px;letter-spacing:2px;color:var(--accent);font-weight:700;}
  .badge-name{font-family:'Orbitron',monospace;font-size:10px;font-weight:900;color:var(--text-primary);letter-spacing:1px;line-height:1.3;}
  .success-card{padding:32px;text-align:center;width:100%;}
  .success-headline{font-family:'Orbitron',monospace;font-size:clamp(20px,4vw,32px);font-weight:900;color:var(--accent);text-shadow:0 0 30px var(--accent-glow);margin-bottom:12px;}
  .success-sub{font-size:16px;color:var(--text-dim);margin-bottom:28px;}
  .share-card{padding:20px 24px;border-radius:12px;background:linear-gradient(135deg,rgba(56,189,248,0.08),rgba(57,255,20,0.05));border:1px solid rgba(56,189,248,0.25);font-family:'Share Tech Mono',monospace;font-size:15px;color:var(--accent);margin-bottom:28px;}
  .mission-report-btn{font-family:'Orbitron',monospace;font-size:11px;letter-spacing:2px;padding:12px 28px;background:rgba(56,189,248,0.1);border:1px solid var(--accent);color:var(--accent);border-radius:4px;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all 0.2s;margin:0 auto;}
  .mission-report-btn:hover{background:rgba(56,189,248,0.2);}

  /* AXIOM DECONSTRUCTION */
  #axiom-deconstruction{display:none;margin-top:20px;}
  .axd-header{display:flex;align-items:center;gap:10px;margin-bottom:14px;}
  .axd-title{font-family:'Orbitron',monospace;font-size:12px;font-weight:700;color:var(--green);letter-spacing:3px;}
  .axd-sub{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);letter-spacing:1px;}
  .axd-badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px;}
  .axd-badge{font-family:'Share Tech Mono',monospace;font-size:11px;padding:6px 12px;border-radius:4px;border:1px solid;letter-spacing:1px;}
  .axd-badge.hit{color:var(--green);border-color:rgba(57,255,20,0.35);background:rgba(57,255,20,0.06);}
  .axd-badge.miss{color:var(--text-dim);border-color:rgba(255,255,255,0.1);background:transparent;}
  .axd-badge.hit::before{content:'‚úì  ';}
  .axd-badge.miss::before{content:'‚óã  ';}
  .axd-text-wrap{background:rgba(255,255,255,0.03);border:1px solid var(--panel-border);border-radius:8px;padding:16px 18px;font-family:'Rajdhani',sans-serif;font-size:15px;font-weight:500;line-height:1.8;color:var(--text-primary);}
  .axd-text-wrap .nei-n{background:rgba(255,59,59,0.25);color:#ffcccc;border-radius:3px;padding:1px 4px;}
  .axd-text-wrap .nei-e{background:rgba(255,149,0,0.25);color:#ffe0aa;border-radius:3px;padding:1px 4px;}
  .axd-text-wrap .nei-i{background:rgba(57,255,20,0.2);color:#bbffaa;border-radius:3px;padding:1px 4px;}
  .axd-legend{display:flex;gap:16px;flex-wrap:wrap;margin-top:12px;}
  .axd-legend-item{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);display:flex;align-items:center;gap:6px;}
  .axd-dot{width:10px;height:10px;border-radius:2px;display:inline-block;}
  .axd-loading{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);letter-spacing:2px;padding:16px 0;display:flex;align-items:center;gap:10px;}
  .axd-spinner{width:14px;height:14px;border:2px solid rgba(57,255,20,0.2);border-top-color:var(--green);border-radius:50%;animation:spin-axd 0.8s linear infinite;}
  @keyframes spin-axd{to{transform:rotate(360deg);}}
  .axd-error{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--amber);letter-spacing:1px;padding:12px 0;}

  /* NAV TABS */
  .nav-tabs{display:flex;gap:8px;position:fixed;bottom:24px;right:24px;z-index:50;flex-direction:column;align-items:flex-end;}
  .nav-tab-btn{font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:1px;padding:8px 16px;background:rgba(13,17,23,0.9);backdrop-filter:blur(10px);border:1px solid var(--panel-border);color:var(--text-dim);border-radius:4px;cursor:pointer;transition:all 0.2s;}
  .nav-tab-btn.active{border-color:var(--accent);color:var(--accent);}
  .nav-tab-btn:hover:not(:disabled){border-color:var(--text-dim);color:var(--text-primary);}
  .nav-tab-btn.locked{border-color:rgba(255,59,59,0.2);color:rgba(232,237,243,0.2);cursor:not-allowed;}
  .nav-tab-btn.locked:hover{border-color:rgba(255,59,59,0.4);color:rgba(255,59,59,0.5);}
  @keyframes tab-reject{0%,100%{transform:translateX(0);}20%{transform:translateX(-5px);}40%{transform:translateX(5px);}60%{transform:translateX(-3px);}80%{transform:translateX(3px);}}
  .nav-tab-btn.rejecting{animation:tab-reject 0.35s ease;}
  #lock-nudge{position:fixed;bottom:28px;right:180px;background:rgba(255,59,59,0.12);border:1px solid rgba(255,59,59,0.4);border-radius:6px;padding:8px 14px;font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--red);letter-spacing:1px;white-space:nowrap;z-index:200;opacity:0;transform:translateX(8px);transition:opacity 0.2s,transform 0.2s;pointer-events:none;}
  #lock-nudge.show{opacity:1;transform:translateX(0);}

  /* GLITCH */
  #glitch-overlay{position:fixed;inset:0;background:var(--void);z-index:999;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none;opacity:0;visibility:hidden;}
  #glitch-overlay.active{visibility:visible;animation:glitch-sequence 1.9s ease-in-out forwards;}
  @keyframes glitch-sequence{0%{opacity:0;}5%{opacity:1;}10%{opacity:0.6;}15%{opacity:1;}85%{opacity:1;}100%{opacity:0;visibility:hidden;}}
  .glitch-scanlines{position:absolute;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(56,189,248,0.03) 3px,rgba(56,189,248,0.03) 4px);pointer-events:none;}
  .glitch-block{position:absolute;width:100%;height:3px;opacity:0;}
  .g1{background:var(--accent);top:28%;animation:gbar1 1.9s ease forwards 0.1s;}
  .g2{background:var(--green);top:50%;height:2px;animation:gbar2 1.9s ease forwards 0.25s;}
  .g3{background:var(--amber);top:70%;animation:gbar3 1.9s ease forwards 0.15s;}
  @keyframes gbar1{0%,100%{opacity:0}10%{opacity:1;transform:translateX(-8%)}14%{opacity:0;transform:translateX(12%)}22%{opacity:1;transform:translateX(-4%)}30%{opacity:0}42%{opacity:0.6;transform:translateX(0)}55%{opacity:0}}
  @keyframes gbar2{0%,100%{opacity:0}18%{opacity:1;transform:translateX(10%) scaleX(0.6)}25%{opacity:0}36%{opacity:0.8;transform:translateX(-5%) scaleX(1.2)}43%{opacity:0}}
  @keyframes gbar3{0%,100%{opacity:0}16%{opacity:1;transform:translateX(6%)}21%{opacity:0;transform:translateX(-10%)}31%{opacity:0.5;transform:translateX(0)}40%{opacity:0}}
  .glitch-text{font-family:'Orbitron',monospace;font-size:clamp(18px,4vw,32px);font-weight:900;color:var(--accent);text-shadow:0 0 30px var(--accent-glow),0 0 60px var(--accent-glow);letter-spacing:6px;text-align:center;position:relative;animation:gtext 1.9s ease-in-out forwards;}
  @keyframes gtext{0%{opacity:0;transform:translateY(8px)}10%{opacity:1;transform:translateY(0)}25%{transform:none}55%{opacity:1;letter-spacing:8px}88%{opacity:0;letter-spacing:12px}100%{opacity:0}}
  .glitch-subtext{font-family:'Share Tech Mono',monospace;font-size:13px;letter-spacing:5px;color:var(--green);margin-top:20px;text-align:center;animation:gsub 1.9s ease-in-out forwards;}
  .glitch-coords{font-family:'Share Tech Mono',monospace;font-size:11px;letter-spacing:3px;color:rgba(56,189,248,0.5);margin-top:12px;text-align:center;animation:gcoords 1.9s ease-in-out forwards;}
  @keyframes gsub{0%,12%{opacity:0}25%{opacity:1}65%{opacity:1}85%{opacity:0}100%{opacity:0}}
  @keyframes gcoords{0%,30%{opacity:0}45%{opacity:1}70%{opacity:0.6}85%{opacity:0}100%{opacity:0}}

  #reboot-overlay{display:none;position:fixed;inset:0;z-index:9999;background:#0D1117;flex-direction:column;align-items:center;justify-content:center;font-family:'Orbitron',monospace;}
  #reboot-overlay .rb-line1{font-size:clamp(11px,2vw,14px);color:var(--accent);letter-spacing:4px;opacity:0;transition:opacity 0.3s;text-align:center;padding:0 20px;}
  #reboot-overlay .rb-line2{font-size:clamp(16px,3.5vw,30px);font-weight:900;color:var(--green);letter-spacing:5px;margin-top:16px;opacity:0;transition:opacity 0.4s;text-align:center;padding:0 20px;}
  #reboot-overlay .rb-bar-wrap{max-width:400px;width:90%;margin-top:32px;}
  #reboot-overlay .rb-bar{height:3px;width:0%;background:var(--accent);box-shadow:0 0 12px var(--accent-glow);transition:none;}
  ::-webkit-scrollbar{width:4px} ::-webkit-scrollbar-track{background:var(--void)} ::-webkit-scrollbar-thumb{background:rgba(56,189,248,0.3);border-radius:2px}
</style>
</head>
<body>

<!-- TOPBAR -->
<nav class="topbar">
  <div class="logo">MARK SCHEME <span>METHOD</span>¬Æ</div>
  <div class="step-dots">
    <div class="step-dot active" id="dot-1"></div>
    <div class="step-dot" id="dot-2"></div>
    <div class="step-dot" id="dot-3"></div>
    <div class="step-dot" id="dot-4"></div>
    <div class="step-dot" id="dot-5"></div>
  </div>
  <div style="display:flex;align-items:center;gap:12px;">
    <a href="../topics.html" style="font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;color:rgba(232,237,243,0.4);text-decoration:none;border:1px solid rgba(255,255,255,0.08);border-radius:4px;padding:5px 12px;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(56,189,248,0.4)';this.style.color='#38BDF8'" onmouseout="this.style.borderColor='rgba(255,255,255,0.08)';this.style.color='rgba(232,237,243,0.4)'">‚Üê TOPICS</a>
    <div class="module-badge">MODULE 6.2</div>
  </div>
</nav>

<!-- SCENE 1: BRIEFING -->
<section class="scene active" id="scene-1">
  <div class="briefing-container">
    <div style="text-align:center;margin-bottom:40px;">
      <span class="mission-tag">CONTENT AREA 6 // DATA IN ORGANISATIONS // 6.2</span>
      <h1 class="mission-title">DATA <span class="ac">FORMATS</span><br><span class="gn">& STRUCTURES</span></h1>
    </div>
    <div class="avatar-briefing">
      <div class="glass avatar-card">
        <div class="avatar-figure">ü§ñ</div>
        <div class="avatar-name">AXIOM-7</div>
        <div class="avatar-title">// DATA ARCHITECT //</div>
        <br>
        <div style="display:flex;flex-direction:column;gap:6px;text-align:left;">
          <div style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);">‚ñ∏ CLEARANCE: SPECIALIST</div>
          <div style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);">‚ñ∏ MODULE: 6.2</div>
          <div style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--accent);">‚ñ∏ FORMAT ALERT: ACTIVE</div>
        </div>
      </div>
      <div class="glass briefing-panel">
        <div class="terminal-label">OPERATIONAL BRIEFING // AXIOM-7 TRANSMISSION</div>
        <div class="briefing-text">
          "Specialist. Data doesn't move itself ‚Äî and it doesn't arrive in the same shape it left.<br><br>
          A retail logistics platform is integrating three separate systems: a <span class="hl-ac">warehouse management tool</span>, a <span class="hl-ac">supplier API</span>, and a <span class="hl-ac">finance spreadsheet export</span>. Each system expects data in a different format. Get it wrong and orders fail silently.<br><br>
          Your mission today: understand why format choice isn't a technical preference ‚Äî it's a <span class="hl-g">business decision</span>. CSV, JSON, XML ‚Äî each has a structure, a cost, and a consequence.<br><br>
          <span class="hl-r">The examiner doesn't want a dictionary entry.</span><br>
          <span class="hl-ac">They want to know what the format choice does to the business.</span> Ready?"
        </div>
        <div class="nei-trio">
          <div class="glass nei-card n-card">
            <div class="nei-letter">N</div><div class="nei-label">NAME</div>
            <div class="nei-desc">Identify the data format or structure type</div>
          </div>
          <div class="glass nei-card e-card">
            <div class="nei-letter">E</div><div class="nei-label">EXPLAIN</div>
            <div class="nei-desc">Describe how the format works and why it's appropriate</div>
          </div>
          <div class="glass nei-card i-card">
            <div class="nei-letter">I</div><div class="nei-label">IMPACT</div>
            <div class="nei-desc">State the measurable business benefit</div>
          </div>
        </div>
        <div class="intel-box">
          <div class="intel-box-title">// FORMAT INTELLIGENCE</div>
          <div class="intel-stat-row">
            <div><div class="intel-stat-val">CSV</div><div class="intel-stat-lbl">LIGHTWEIGHT<br>SPREADSHEET-FRIENDLY</div></div>
            <div><div class="intel-stat-val">JSON</div><div class="intel-stat-lbl">WEB APIs<br>NESTED STRUCTURE</div></div>
            <div><div class="intel-stat-val">XML</div><div class="intel-stat-lbl">SELF-DESCRIBING<br>ENTERPRISE LEGACY</div></div>
          </div>
        </div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn-primary" onclick="goScene(2)"><span>‚ü∂ START MISSION</span></button>
    </div>
  </div>
</section>

<!-- SCENE 2: FORMAT CLASSIFIER -->
<section class="scene" id="scene-2">
  <div class="dd-container">
    <span class="scene-label">SCENE 02 // FORMAT CLASSIFIER // INTERACTIVE TASK</span>
    <h2 class="scene-headline">Match the <span style="color:var(--accent)">Data Transfer Task</span> to the Right Format</h2>
    <p style="font-family:'Share Tech Mono',monospace;font-size:12px;color:var(--text-dim);margin-bottom:24px;line-height:1.7;">
      A retail logistics company is connecting three systems. Drag each data exchange task to the most appropriate format. Think: what does each system need? What does each format support?
    </p>
    <div class="dd-pool-label">// DATA TRANSFER TASKS ‚Äî DRAG TO CORRECT FORMAT</div>
    <div class="chips-pool" id="chips-pool">
      <div class="data-chip" draggable="true" id="chip-a" data-answer="csv"><span style="color:var(--amber);font-family:monospace;">"Export 10,000 sales records to Excel for finance"</span></div>
      <div class="data-chip" draggable="true" id="chip-b" data-answer="json"><span style="color:var(--accent);font-family:monospace;">"Send product stock data to supplier via web API"</span></div>
      <div class="data-chip" draggable="true" id="chip-c" data-answer="xml"><span style="color:var(--green);font-family:monospace;">"Integrate order data with a legacy enterprise ERP system"</span></div>
    </div>
    <div class="dd-targets">
      <div class="drop-zone glass" data-target="csv">
        <div class="dz-badge" style="background:rgba(255,149,0,0.15);color:var(--amber);border:1px solid rgba(255,149,0,0.4);">CSV</div>
        <div class="dz-label">
          <div class="dz-desc">Comma-Separated Values ‚Äî plain text, one row per record, no nesting, opens directly in Excel</div>
          <div class="dz-answer dz-empty" id="drop-csv">Drop here...</div>
        </div>
      </div>
      <div class="drop-zone glass" data-target="json">
        <div class="dz-badge" style="background:rgba(56,189,248,0.15);color:var(--accent);border:1px solid rgba(56,189,248,0.4);">JSON</div>
        <div class="dz-label">
          <div class="dz-desc">JavaScript Object Notation ‚Äî lightweight, supports nested data, the standard for modern web APIs</div>
          <div class="dz-answer dz-empty" id="drop-json">Drop here...</div>
        </div>
      </div>
      <div class="drop-zone glass" data-target="xml">
        <div class="dz-badge" style="background:rgba(57,255,20,0.1);color:var(--green);border:1px solid rgba(57,255,20,0.3);">XML</div>
        <div class="dz-label">
          <div class="dz-desc">eXtensible Markup Language ‚Äî self-describing tags, handles complex hierarchies, widely used in enterprise/government systems</div>
          <div class="dz-answer dz-empty" id="drop-xml">Drop here...</div>
        </div>
      </div>
    </div>
    <div class="dd-feedback" id="dd-feedback"></div>
    <div class="btn-row" style="margin-top:24px;">
      <button class="btn-ghost" onclick="goScene(1)">‚Üê BACK</button>
      <button class="btn-primary" onclick="checkDragDrop()"><span>‚Üí CHECK ANSWERS</span></button>
    </div>
  </div>
</section>

<!-- SCENE 3: MISSION TERMINAL -->
<section class="scene" id="scene-3">
  <div class="mission-layout">
    <div class="glass terminal-panel">
      <div class="terminal-header">
        <div class="terminal-dots"><div class="tdot r"></div><div class="tdot y"></div><div class="tdot b"></div></div>
        <div class="terminal-path">msm://exam/content-6.2/data-formats-json-q1</div>
      </div>
      <div class="question-block">
        <div class="q-tag">// EXAM QUESTION // CONTENT AREA 6.2 // DATA FORMATS</div>
        <div class="q-text">
          A logistics company sends daily shipment updates to <span style="color:var(--accent);font-family:monospace;font-size:15px;">multiple international partners</span> via an automated API. Explain one advantage of using <span style="color:var(--accent);font-family:monospace;font-size:15px;">JSON</span> over XML for this data transfer.
          <span class="q-marks">3 MARKS</span>
        </div>
      </div>
      <div class="answer-area">
        <div style="font-family:'Share Tech Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--text-dim);margin-bottom:12px;">YOUR RESPONSE // USE N.E.I. STRUCTURE</div>
        <textarea class="answer-textarea" id="student-answer" maxlength="600"
          oninput="updateHUD(this.value);updateWordCount(this.value);resetIdleTimer(this.value)"
          onkeyup="updateHUD(this.value);updateWordCount(this.value);resetIdleTimer(this.value)"
          onpaste="setTimeout(()=>{const v=this.value;updateHUD(v);updateWordCount(v);resetIdleTimer(v);},10)"
          placeholder="Name the format advantage, explain the technical mechanism (file size, parsing, structure), and state the measurable business benefit (cost, speed, scalability)..."></textarea>
        <div class="energy-bar-wrap">
          <div class="energy-bar-track"><div class="energy-bar-fill" id="energy-bar-fill"></div></div>
          <div class="energy-bar-label" id="word-count-display">0 words ‚Äî aim for 60+</div>
        </div>
        <div id="axiom-feedback" style="display:none;margin-top:14px;padding:14px 18px;border-radius:8px;font-family:'Share Tech Mono',monospace;font-size:12px;line-height:1.6;border:1px solid var(--amber);background:rgba(255,149,0,0.06);color:var(--amber);animation:fade-in 0.4s ease both;"></div>
      </div>
      <div style="padding:0 20px 20px;">
        <div class="btn-row" style="margin-top:0;justify-content:flex-start;">
          <button class="btn-ghost" onclick="goScene(2)">‚Üê BACK</button>
          <button class="btn-primary" onclick="submitAnswer()"><span>‚ü∂ SUBMIT FOR CALIBRATION</span></button>
        </div>
      </div>
    </div>
    <!-- HUD -->
    <div class="glass method-ribbon">
      <div class="ribbon-title">METHOD RIBBON</div>
      <div class="nei-hud-item hud-n" id="hud-n">
        <span class="hud-letter">N</span>
        <div class="hud-label">NAME</div>
        <div class="hud-hint">The format ‚Äî JSON</div>
      </div>
      <div class="nei-hud-item hud-e" id="hud-e">
        <span class="hud-letter">E</span>
        <div class="hud-label">EXPLAIN</div>
        <div class="hud-hint">Why it's lighter / faster to parse</div>
      </div>
      <div class="nei-hud-item hud-i" id="hud-i">
        <span class="hud-letter">I</span>
        <div class="hud-label">IMPACT</div>
        <div class="hud-hint">Business outcome: cost / speed / scale</div>
      </div>
      <div style="padding-top:12px;border-top:1px solid var(--panel-border);font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);line-height:1.7;">
        ‚ñ∏ N+E = 2 marks<br>‚ñ∏ N+E+I = 3 marks<br>‚ñ∏ I alone = 0 marks
      </div>
    </div>
  </div>
</section>

<!-- SCENE 4: CALIBRATION -->
<section class="scene" id="scene-4">
  <div class="calibration-layout">
    <div class="cal-main">
      <div>
        <span class="scene-label">SCENE 04 // SELF-CALIBRATION // NEI DECONSTRUCTION</span>
        <h2 class="scene-headline" style="text-align:left;">Mark Your <span style="color:var(--green)">Own Work</span></h2>
      </div>
      <div class="glass model-answer-panel">
        <div class="ma-title">// MODEL ANSWER // 3 MARKS ACHIEVED</div>
        <div class="ma-text">
          <span class="ma-n">[N] <strong>JSON (JavaScript Object Notation)</strong> is a lightweight, text-based data format that uses key-value pairs to structure data, and is the standard format for web-based API communication.</span>
          &nbsp;
          <span class="ma-e">[E] <strong>Mechanism:</strong> Unlike XML, JSON does not require closing tags or a document type declaration, meaning each data packet transmitted between the logistics system and its international partners is significantly smaller in file size and faster for receiving systems to parse.</span>
          &nbsp;
          <span class="ma-i">[I] <strong>Impact:</strong> This reduces server processing time and bandwidth consumption, allowing the company to scale automated data exchange across hundreds of partners without proportional increases in infrastructure cost, directly improving operational efficiency.</span>
        </div>
        <div class="ma-legend">
          <div class="legend-item"><div class="legend-dot" style="background:rgba(255,59,59,0.5);"></div><span style="color:#ff8888;">[N] Name</span></div>
          <div class="legend-item"><div class="legend-dot" style="background:rgba(255,149,0,0.5);"></div><span style="color:#ffcc88;">[E] Explain</span></div>
          <div class="legend-item"><div class="legend-dot" style="background:rgba(57,255,20,0.4);"></div><span style="color:#aaff88;">[I] Impact</span></div>
        </div>
      </div>
      <div class="glass student-answer-area">
        <div class="sa-title">// YOUR ANSWER // SELECT TEXT TO HIGHLIGHT</div>
        <div id="student-display"></div>
      </div>
      <div class="glass" id="axiom-deconstruction" style="padding:20px;">
        <div class="axd-header">
          <div>
            <div class="axd-title">AXIOM-7 // NEI DECONSTRUCTION</div>
            <div class="axd-sub">// AI-ASSISTED ANALYSIS ‚Äî COMPARE WITH YOUR OWN TAGGING ABOVE</div>
          </div>
        </div>
        <div id="axd-content"><div class="axd-loading"><div class="axd-spinner"></div>SCANNING RESPONSE...</div></div>
      </div>
      <div class="vulnerability-alert" id="vuln-alert">
        <div class="vuln-header"><div class="vuln-icon">‚ö†</div>AXIOM-7 // TECHNIQUE GAP DETECTED</div>
        <div class="vuln-msg">
          <strong>You've described what JSON is and how it works ‚Äî but the examiner hasn't seen the Impact yet.</strong><br><br>
          What actually happens to the business when data transfers are faster and smaller? Think: server costs, processing time, ability to scale to more partners without bigger infrastructure bills.<br><br>
          No [I] tag = no third mark confirmed.
        </div>
      </div>
      <div class="success-alert" id="success-alert">
        <div class="success-header">‚úì CALIBRATION COMPLETE ‚Äî 3/3 TECHNIQUE CONFIRMED</div>
        <div style="font-family:'Share Tech Mono',monospace;font-size:13px;color:var(--text-dim);line-height:1.7;">Full N.E.I. structure detected. You've named the format, explained the technical mechanism, and stated a measurable operational impact. That's a 3-mark answer.</div>
        <div class="nei-tally">
          <div class="tally-chip tally-n">‚úì [N] Named</div>
          <div class="tally-chip tally-e">‚úì [E] Explained</div>
          <div class="tally-chip tally-i">‚úì [I] Impact</div>
        </div>
      </div>
      <div style="display:flex;gap:16px;justify-content:center;flex-wrap:wrap;">
        <button class="btn-primary" id="complete-btn" onclick="goScene(5)" style="display:none;"><span>‚úì COMPLETE MISSION</span></button>
        <button class="btn-ghost" onclick="runCalibration()">‚ñ∂ RUN CALIBRATION</button>
      </div>
    </div>
    <!-- HIGHLIGHT TOOLBAR -->
    <div class="glass highlight-toolbar">
      <div class="toolbar-title">HIGHLIGHT TOOL</div>
      <button class="hl-btn hl-n" id="btn-n" onclick="setMode('n')"><span style="font-size:18px;">üî¥</span> [N] NAME</button>
      <button class="hl-btn hl-e" id="btn-e" onclick="setMode('e')"><span style="font-size:18px;">üü†</span> [E] EXPLAIN</button>
      <button class="hl-btn hl-i" id="btn-i" onclick="setMode('i')"><span style="font-size:18px;">üü¢</span> [I] IMPACT</button>
      <div class="hl-instructions">1. Select a mode above<br>2. Click and drag to highlight<br>3. Tag each N.E.I. component<br>4. Click RUN CALIBRATION</div>
      <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--panel-border);">
        <div style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--text-dim);margin-bottom:8px;">6.2 IMPACT CHECKLIST</div>
        <div style="font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--text-dim);line-height:1.8;">‚ñ∏ Bandwidth / cost<br>‚ñ∏ Processing speed<br>‚ñ∏ Scalability<br>‚ñ∏ Integration efficiency<br>‚ñ∏ Reduce errors / failures</div>
      </div>
    </div>
  </div>
</section>

<!-- SCENE 5: SUCCESS -->
<section class="scene" id="scene-5">
  <div class="success-scene">
    <div class="badge-3d" onclick="exportReport()">
      <div class="badge-inner">
        <div class="badge-icon">üóÇÔ∏è</div>
        <div class="badge-rank">MODULE 6.2</div>
        <div class="badge-name">DATA ARCHITECT</div>
      </div>
    </div>
    <div class="glass success-card">
      <div class="success-headline">MISSION COMPLETE</div>
      <div class="success-sub">You've mastered Data Formats. The third mark is always the business outcome.</div>
      <div class="share-card">
        "The difference between CSV and JSON isn't a technicality ‚Äî it's bandwidth costs, integration speed, and the ability to scale. That's what earns the Impact mark."
      </div>
      <button class="mission-report-btn" onclick="exportReport()">‚¨á EXPORT MISSION REPORT</button>
    </div>
    <div class="btn-row">
      <a href="../topics.html" style="text-decoration:none;"><button class="btn-ghost">‚Üê BACK TO TOPICS</button></a>
      <a href="../6-3/index.html" style="text-decoration:none;"><button class="btn-primary"><span>‚ü∂ MODULE 6.3</span></button></a>
    </div>
  </div>
</section>

<!-- GLITCH -->
<div id="glitch-overlay" aria-hidden="true">
  <div class="glitch-scanlines"></div>
  <div class="glitch-block g1"></div>
  <div class="glitch-block g2"></div>
  <div class="glitch-block g3"></div>
  <div class="glitch-text">FORMAT CLASSIFIED. TERMINAL UNLOCKING...</div>
  <div class="glitch-subtext">ACCESSING MISSION TERMINAL</div>
  <div class="glitch-coords">JSON // CSV // XML // FORMAT MATTERS</div>
</div>

<div id="lock-nudge">‚ö° COMPLETE THE FORMAT CLASSIFIER FIRST</div>
<div class="nav-tabs" id="floating-nav">
  <button class="nav-tab-btn active" onclick="goScene(1)" id="navbtn-1">01 BRIEF</button>
  <button class="nav-tab-btn" onclick="goScene(2)" id="navbtn-2">02 LESSON</button>
  <button class="nav-tab-btn locked" id="navbtn-3" disabled>üîí 03 MISSION</button>
  <button class="nav-tab-btn locked" id="navbtn-4" disabled>üîí 04 CALIBRATE</button>
  <button class="nav-tab-btn locked" id="navbtn-5" disabled>üîí 05 BADGE</button>
</div>

<div id="reboot-overlay">
  <div class="rb-line1" id="rb-line1">FORMAT ADVANTAGE CONFIRMED</div>
  <div class="rb-line2" id="rb-line2">CALIBRATING SPECIALIST GRADE</div>
  <div class="rb-bar-wrap"><div class="rb-bar" id="rb-bar"></div></div>
</div>

<script>
/* ‚îÄ‚îÄ GATEKEEPER ‚îÄ‚îÄ */
let sorterComplete = false, nudgeTimer = null, glitchTriggerTimer = null, glitchNavTimer = null, glitchCleanTimer = null;

document.getElementById('floating-nav').addEventListener('mousedown', e => {
  const btn = e.target.closest('.nav-tab-btn.locked');
  if (!btn) return;
  btn.classList.remove('rejecting'); void btn.offsetWidth; btn.classList.add('rejecting');
  btn.addEventListener('animationend', () => btn.classList.remove('rejecting'), {once:true});
  const nudge = document.getElementById('lock-nudge');
  nudge.classList.add('show'); clearTimeout(nudgeTimer);
  nudgeTimer = setTimeout(() => nudge.classList.remove('show'), 2200);
});

function unlockTabs() {
  if (sorterComplete) return; sorterComplete = true;
  [{id:'navbtn-3',label:'03 MISSION',scene:3},{id:'navbtn-5',label:'05 BADGE',scene:5}].forEach(({id,label,scene}) => {
    const btn = document.getElementById(id);
    btn.classList.remove('locked'); btn.disabled = false;
    btn.textContent = label; btn.setAttribute('onclick',`goScene(${scene})`);
  });
}

function glitchToMission() {
  const overlay = document.getElementById('glitch-overlay');
  unlockTabs(); overlay.classList.remove('active'); void overlay.offsetWidth; overlay.classList.add('active');
  glitchNavTimer = setTimeout(() => { glitchNavTimer = null; goScene(3); }, 950);
  glitchCleanTimer = setTimeout(() => { glitchCleanTimer = null; overlay.classList.remove('active'); }, 2000);
}

/* ‚îÄ‚îÄ SCENE NAV ‚îÄ‚îÄ */
let currentScene = 1;
function goScene(n) {
  if (glitchTriggerTimer) { clearTimeout(glitchTriggerTimer); glitchTriggerTimer = null; }
  if (glitchNavTimer) { clearTimeout(glitchNavTimer); glitchNavTimer = null; }
  if (glitchCleanTimer) { clearTimeout(glitchCleanTimer); glitchCleanTimer = null; }
  document.getElementById('glitch-overlay').classList.remove('active');
  document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
  document.getElementById('scene-' + n).classList.add('active');
  document.querySelectorAll('.step-dot').forEach((d, i) => {
    d.classList.remove('active','done');
    if (i+1 < n && n <= 5) d.classList.add('done');
    else if (i+1 === n) d.classList.add('active');
  });
  [1,2,3,4,5].forEach(i => { const b = document.getElementById('navbtn-'+i); if(b) b.classList.remove('active'); });
  const ab = document.getElementById('navbtn-'+n);
  if (ab && !ab.classList.contains('locked')) ab.classList.add('active');
  document.getElementById('floating-nav').style.display = 'flex';
  currentScene = n; window.scrollTo(0,0);
  if (n === 3) {
    clearInterval(window._textPoll);
    window._textPoll = setInterval(() => {
      const ta = document.getElementById('student-answer'); if(!ta) return;
      const v = ta.value;
      if (v !== (window._lastPolledValue||'')) { window._lastPolledValue = v; updateHUD(v); updateWordCount(v); }
    }, 400);
  } else { clearInterval(window._textPoll); }
  if (n === 4) prepCalibration();
}

/* ‚îÄ‚îÄ SCENE 2: DRAG AND DROP ‚îÄ‚îÄ */
(function initDnD() {
  const chips = document.querySelectorAll('.data-chip');
  const zones = document.querySelectorAll('.drop-zone');
  function dropChipOnZone(chip, zone) {
    const target = zone.dataset.target;
    const prev = document.getElementById('drop-' + target);
    if (prev && prev.dataset.chipId && prev.dataset.chipId !== chip.id) {
      const old = document.getElementById(prev.dataset.chipId);
      if (old) { old.style.display = ''; document.getElementById('chips-pool').appendChild(old); }
    }
    const display = document.getElementById('drop-' + target);
    display.textContent = chip.textContent; display.classList.remove('dz-empty');
    display.dataset.chipId = chip.id; chip.style.display = 'none';
  }
  function clearZoneHighlights() { zones.forEach(z => z.classList.remove('over')); }
  chips.forEach(chip => {
    chip.addEventListener('dragstart', e => { e.dataTransfer.setData('chipId', chip.id); chip.classList.add('dragging'); });
    chip.addEventListener('dragend', () => chip.classList.remove('dragging'));
  });
  zones.forEach(zone => {
    zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('over'); });
    zone.addEventListener('dragleave', () => zone.classList.remove('over'));
    zone.addEventListener('drop', e => { e.preventDefault(); clearZoneHighlights(); const chip = document.getElementById(e.dataTransfer.getData('chipId')); if(chip) dropChipOnZone(chip, zone); });
  });
  let touchChip = null, touchClone = null;
  chips.forEach(chip => {
    chip.addEventListener('touchstart', e => {
      touchChip = chip; chip.classList.add('dragging');
      touchClone = chip.cloneNode(true);
      touchClone.style.cssText = `position:fixed;pointer-events:none;z-index:9999;opacity:0.85;transform:scale(1.05);transition:none;margin:0;width:${chip.offsetWidth}px;`;
      document.body.appendChild(touchClone); moveTouchClone(e.touches[0]);
    }, {passive:true});
    chip.addEventListener('touchmove', e => {
      e.preventDefault(); if(!touchClone) return;
      moveTouchClone(e.touches[0]); clearZoneHighlights();
      const el = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
      const zone = el && el.closest('.drop-zone'); if(zone) zone.classList.add('over');
    }, {passive:false});
    chip.addEventListener('touchend', e => {
      if (!touchChip || !touchClone) return;
      const touch = e.changedTouches[0]; clearZoneHighlights();
      touchClone.remove(); touchClone = null; touchChip.classList.remove('dragging');
      const el = document.elementFromPoint(touch.clientX, touch.clientY);
      const zone = el && el.closest('.drop-zone');
      if(zone) dropChipOnZone(touchChip, zone); touchChip = null;
    });
  });
  function moveTouchClone(touch) {
    if(!touchClone) return;
    touchClone.style.left = (touch.clientX - touchClone.offsetWidth/2) + 'px';
    touchClone.style.top  = (touch.clientY - 24) + 'px';
  }
})();

function checkDragDrop() {
  const fb = document.getElementById('dd-feedback');
  const zones = document.querySelectorAll('.drop-zone');
  let correct = 0;
  zones.forEach(zone => {
    const target = zone.dataset.target;
    const el = document.getElementById('drop-' + target);
    const chipId = el && el.dataset.chipId;
    zone.classList.remove('correct','incorrect');
    if (!chipId) return;
    const chip = document.getElementById(chipId);
    if (chip && chip.dataset.answer === target) { zone.classList.add('correct'); correct++; }
    else zone.classList.add('incorrect');
  });
  fb.classList.add('show');
  if (correct === 3) {
    fb.className = 'dd-feedback show success';
    fb.innerHTML = '‚úì FORMAT CLASSIFICATION CORRECT ‚Äî Excel exports need the flat, human-readable simplicity of CSV. Web APIs need the lightweight, nestable structure of JSON. Legacy enterprise systems require the self-describing, schema-rich depth of XML. You understand the business context behind each format. Mission Terminal unlocking...';
    glitchTriggerTimer = setTimeout(() => { glitchTriggerTimer = null; glitchToMission(); }, 600);
  } else {
    fb.className = 'dd-feedback show error';
    fb.innerHTML = `‚úó ${correct}/3 CORRECT ‚Äî Ask yourself: who receives this data? A finance analyst using Excel (CSV), a web service that needs speed (JSON), or an enterprise system built on structured schemas (XML)?`;
  }
}

/* ‚îÄ‚îÄ SCENE 3: HUD ‚îÄ‚îÄ */
const N_WORDS = ['json','javascript object notation','csv','comma-separated','xml','extensible markup','format','data format','structure','plain text','key-value','lightweight'];
const E_WORDS = ['tag','tags','closing','declaration','file size','smaller','parse','parsing','bandwidth','transmit','header','columns','rows','nested','nesting','compact','schema','without','no closing','less overhead','readable','bytes'];
const I_WORDS = ['cost','speed','faster','scalab','effici','reduc','bandwidth','infrastructure','processing','integrat','compati','partners','scale','overhead','performance','cheaper','quicker','automatic'];

function hasKeyword(text, words) { const t = text.toLowerCase(); return words.some(w => t.includes(w)); }
function countWords(text) { return text.trim() === '' ? 0 : text.trim().split(/\s+/).length; }

const IDLE_DELAY = 10000;
const IDLE_PROMPT = 'You\'ve described the format. But what does a smaller file size actually do for the business?\nThink: server bills, processing time, how many partners they can connect to.';
let idleTimer = null;

function updateWordCount(text) {
  const count = countWords(text);
  const el = document.getElementById('word-count-display');
  const fill = document.getElementById('energy-bar-fill');
  if (!el || !fill) return;
  const pct = Math.min(100, Math.round((count/60)*100));
  fill.style.width = pct + '%';
  fill.classList.remove('eb-red','eb-amber','eb-green');
  if (count === 0) { el.textContent = '0 words ‚Äî aim for 60+'; el.style.color = ''; }
  else if (count < 40) { fill.classList.add('eb-red'); el.textContent = count + ' words ‚Äî keep going'; el.style.color = 'var(--red)'; }
  else if (count < 60) { fill.classList.add('eb-amber'); el.textContent = count + ' words ‚Äî almost there'; el.style.color = 'var(--amber)'; }
  else { fill.classList.add('eb-green'); el.textContent = count + ' words ‚úì'; el.style.color = 'var(--green)'; }
  const iA = hasKeyword(text, I_WORDS);
  if (iA && count >= 60) triggerHUDGlitch();
  const hudI = document.getElementById('hud-i');
  if (hudI) {
    if (count >= 50 && !hudI.classList.contains('active-i')) hudI.style.animation = 'impact-pulse 1.8s ease infinite';
    else hudI.style.animation = '';
  }
}

function resetIdleTimer(text) {
  clearTimeout(idleTimer);
  if (countWords(text) >= 60) return;
  idleTimer = setTimeout(() => {
    const fb = document.getElementById('axiom-feedback');
    if (!fb || fb.style.display !== 'none') return;
    fb.style.display = 'block'; fb.style.borderColor = 'rgba(57,255,20,0.4)';
    fb.style.background = 'rgba(57,255,20,0.05)'; fb.style.color = 'var(--green)';
    fb.textContent = 'AXIOM-7 // ' + IDLE_PROMPT;
  }, IDLE_DELAY);
}

function triggerHUDGlitch() {
  const hudI = document.getElementById('hud-i');
  if (hudI.dataset.glitched) return;
  hudI.dataset.glitched = '1';
  hudI.style.animation = 'hud-glitch 0.5s ease';
  setTimeout(() => { hudI.style.animation = ''; delete hudI.dataset.glitched; }, 600);
}

function updateHUD(text) {
  const nA = hasKeyword(text, N_WORDS);
  const eA = hasKeyword(text, E_WORDS);
  const iA = hasKeyword(text, I_WORDS);
  document.getElementById('hud-n').className = 'nei-hud-item hud-n' + (nA ? ' active-n' : '');
  document.getElementById('hud-e').className = 'nei-hud-item hud-e' + (eA ? ' active-e' : '');
  document.getElementById('hud-i').className = 'nei-hud-item hud-i' + (iA ? ' active-i' : '');
  if (nA && eA && iA) window._msmAllHUDActive = true;
  const wc = countWords(text);
  if (nA && eA && iA && wc >= 60 && wc <= 70) window._msmPrecisionWriter = true;
}

let submitAttempts = 0;
const TIER1_MSG = `‚ö† AXIOM-7 // INSUFFICIENT SIGNAL DETECTED\n\nYour response needs more depth. The examiner needs three things: the format name, why it's technically better for this use case, and what it actually does to the business.\n\nAim for at least 60 words. The third mark is always in your last sentence.`;
const TIER2_TEMPLATE = `Try this structure:\n\n[N] JSON is a lightweight data format that...\n[E] Unlike XML, JSON does not require [EXPLAIN THE TECHNICAL DIFFERENCE ‚Äî tags, size, parsing speed]...\n[I] This means the business [STATE THE OUTCOME ‚Äî bandwidth cost, processing speed, scalability]...`;

function submitAnswer() {
  const answer = document.getElementById('student-answer').value.trim();
  if (!answer) { alert('Please write your answer before submitting.'); return; }
  const words = countWords(answer);
  const fb = document.getElementById('axiom-feedback');
  submitAttempts++;
  if (words < 60) {
    fb.style.display = 'block';
    if (submitAttempts === 1) {
      fb.style.borderColor = 'var(--amber)'; fb.style.background = 'rgba(255,149,0,0.06)';
      fb.style.color = 'var(--amber)'; fb.style.whiteSpace = 'pre-line'; fb.textContent = TIER1_MSG;
    } else {
      fb.style.borderColor = 'var(--red)'; fb.style.background = 'rgba(255,59,59,0.06)';
      fb.style.color = 'var(--text-primary)'; fb.style.whiteSpace = 'pre-line'; fb.textContent = TIER2_TEMPLATE;
      document.getElementById('student-answer').placeholder = '[N] JSON is a lightweight data format...\n[E] Unlike XML, it does not require closing tags so...\n[I] This means the business can reduce bandwidth costs by...';
    }
    const btn = document.querySelector('#scene-3 .btn-primary');
    if (btn) { btn.style.animation = 'tab-reject 0.4s ease'; setTimeout(() => { btn.style.animation = ''; }, 450); }
    return;
  }
  fb.style.display = 'none';
  const btn4 = document.getElementById('navbtn-4');
  btn4.classList.remove('locked'); btn4.disabled = false;
  btn4.textContent = '04 CALIBRATE'; btn4.setAttribute('onclick','goScene(4)');
  triggerReboot();
}

function triggerReboot() {
  const overlay = document.getElementById('reboot-overlay');
  const line1 = document.getElementById('rb-line1');
  const line2 = document.getElementById('rb-line2');
  const bar   = document.getElementById('rb-bar');
  overlay.style.display = 'flex';
  setTimeout(() => { line1.style.opacity = '1'; }, 200);
  setTimeout(() => { line2.style.opacity = '1'; }, 700);
  setTimeout(() => { bar.style.transition = 'width 1.2s ease-out'; bar.style.width = '100%'; }, 1000);
  setTimeout(() => {
    overlay.style.display = 'none'; line1.style.opacity = '0'; line2.style.opacity = '0';
    bar.style.transition = 'none'; bar.style.width = '0%'; goScene(4);
  }, 2400);
  const answer = document.getElementById('student-answer').value.trim();
  window._neiApiPromise = analyzeWithNEIChecker(answer, 'Focus on JSON data format advantages over XML, lightweight structure, no closing tags, faster parsing, bandwidth efficiency, and measurable business outcomes such as reduced costs, faster processing, and scalability');
}

/* ‚îÄ‚îÄ NEI API ‚îÄ‚îÄ */
async function analyzeWithNEIChecker(studentText, customPrompt = '') {
  const r = await fetch('https://neichecker.toolsforteaching.co.uk/nei-checker.php', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({studentText, prompt: customPrompt})
  });
  if (!r.ok) throw new Error(`HTTP ${r.status}`);
  const d = await r.json();
  if (!d.success) throw new Error(d.error || 'Analysis failed');
  return d;
}

function renderAxiomDeconstruction(result) {
  const content = document.getElementById('axd-content');
  document.getElementById('axiom-deconstruction').style.display = 'block';
  const {hasName, hasExplain, hasImpact} = result.analysis;
  let html = result.highlightedHtml || result.originalText || '';
  html = html.replace(/style=['"][^'"]*color\s*:\s*#ff6b6b[^'"]*['"]/gi,'class="nei-n"');
  html = html.replace(/style=['"][^'"]*color\s*:\s*#ffa500[^'"]*['"]/gi,'class="nei-e"');
  html = html.replace(/style=['"][^'"]*color\s*:\s*#51cf66[^'"]*['"]/gi,'class="nei-i"');
  content.innerHTML = `
    <div class="axd-badges">
      <div class="axd-badge ${hasName?'hit':'miss'}">[N] NAME</div>
      <div class="axd-badge ${hasExplain?'hit':'miss'}">[E] EXPLAIN</div>
      <div class="axd-badge ${hasImpact?'hit':'miss'}">[I] IMPACT</div>
    </div>
    ${!hasImpact?`<div style="font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--red);letter-spacing:1px;margin-bottom:12px;padding:10px 12px;border:1px solid rgba(255,59,59,0.25);border-radius:6px;background:rgba(255,59,59,0.05);">‚ö† AXIOM-7 // NO IMPACT COMPONENT DETECTED ‚Äî THIRD MARK AT RISK</div>`:''}
    <div class="axd-text-wrap">${html}</div>
    <div class="axd-legend">
      <div class="axd-legend-item"><div class="axd-dot" style="background:rgba(255,59,59,0.5);"></div>[N] NAME</div>
      <div class="axd-legend-item"><div class="axd-dot" style="background:rgba(255,149,0,0.5);"></div>[E] EXPLAIN</div>
      <div class="axd-legend-item"><div class="axd-dot" style="background:rgba(57,255,20,0.4);"></div>[I] IMPACT</div>
    </div>`;
}

/* ‚îÄ‚îÄ SCENE 4: CALIBRATION ‚îÄ‚îÄ */
let currentMode = null, taggedN = false, taggedE = false, taggedI = false;

function prepCalibration() {
  const answer = document.getElementById('student-answer').value.trim();
  document.getElementById('student-display').innerText = answer || '(No answer entered ‚Äî go back to Scene 3 to write your answer.)';
  document.getElementById('vuln-alert').classList.remove('show');
  document.getElementById('success-alert').classList.remove('show');
  document.getElementById('complete-btn').style.display = 'none';
  taggedN = false; taggedE = false; taggedI = false; currentMode = null;
  ['btn-n','btn-e','btn-i'].forEach(id => document.getElementById(id).classList.remove('active'));
  const content = document.getElementById('axd-content');
  document.getElementById('axiom-deconstruction').style.display = 'block';
  content.innerHTML = '<div class="axd-loading"><div class="axd-spinner"></div>SCANNING RESPONSE...</div>';
  if (window._neiApiPromise) {
    window._neiApiPromise.then(renderAxiomDeconstruction).catch(() => {
      content.innerHTML = '<div class="axd-error">‚ö† AXIOM-7 OFFLINE ‚Äî Complete your self-tagging above.</div>';
    });
  } else if (answer) {
    analyzeWithNEIChecker(answer, 'Focus on JSON data format advantages over XML, lightweight structure, no closing tags, faster parsing, bandwidth efficiency, and measurable business outcomes such as reduced costs, faster processing, and scalability')
      .then(renderAxiomDeconstruction).catch(() => {
        content.innerHTML = '<div class="axd-error">‚ö† AXIOM-7 OFFLINE ‚Äî Complete your self-tagging above.</div>';
      });
  } else { document.getElementById('axiom-deconstruction').style.display = 'none'; }
}

function setMode(m) {
  currentMode = m;
  ['btn-n','btn-e','btn-i'].forEach(id => document.getElementById(id).classList.remove('active'));
  document.getElementById('btn-' + m).classList.add('active');
}

document.addEventListener('mouseup', () => {
  if (!currentMode) return;
  const sel = window.getSelection();
  if (!sel || sel.isCollapsed) return;
  const display = document.getElementById('student-display');
  if (!display || !display.contains(sel.anchorNode)) return;
  try {
    const range = sel.getRangeAt(0);
    const span = document.createElement('span');
    span.className = 'hl-' + currentMode + '-tag';
    range.surroundContents(span);
    if (currentMode === 'n') taggedN = true;
    if (currentMode === 'e') taggedE = true;
    if (currentMode === 'i') taggedI = true;
  } catch(err) {}
  sel.removeAllRanges();
});

function runCalibration() {
  const vuln = document.getElementById('vuln-alert');
  const succ = document.getElementById('success-alert');
  const btn  = document.getElementById('complete-btn');
  vuln.classList.remove('show'); succ.classList.remove('show'); btn.style.display = 'none';
  if (!taggedI) {
    vuln.classList.add('show'); vuln.scrollIntoView({behavior:'smooth',block:'center'});
    window._msmVulnTriggered = true;
  } else {
    succ.classList.add('show'); btn.style.display = 'inline-flex';
    succ.scrollIntoView({behavior:'smooth',block:'center'});
    msmCheckBadges_62();
  }
}

/* ‚îÄ‚îÄ BADGE SYSTEM ‚îÄ‚îÄ */
const MSM_LS = 'msm_badges';
function msmEarnBadge(key) {
  try {
    const b = JSON.parse(localStorage.getItem(MSM_LS)) || {};
    if (b[key]) return false;
    b[key] = {earned:true, ts:Date.now()};
    localStorage.setItem(MSM_LS, JSON.stringify(b)); return true;
  } catch(e) { return false; }
}
function msmCheckBadges_62() {
  msmEarnBadge('data_architect');
  const fb = document.getElementById('axiom-feedback');
  if (!fb || fb.style.display === 'none' || fb.style.display === '') msmEarnBadge('first_strike');
  if (window._msmVulnTriggered) { msmEarnBadge('signal_recovered'); window._msmVulnTriggered = false; }
  if (window._msmAllHUDActive) msmEarnBadge('impact_specialist');
  if (submitAttempts >= 3) msmEarnBadge('resilient_analyst');
  if (window._msmPrecisionWriter) msmEarnBadge('precision_writer');
  try {
    const b = JSON.parse(localStorage.getItem(MSM_LS)) || {};
    const allDone = ['raw_signal','market_intelligence','signal_mapper','data_architect','systems_analyst','compliance_officer'].every(k=>b[k]);
    if (allDone) msmEarnBadge('full_clearance');
  } catch(e) {}
}

/* ‚îÄ‚îÄ EXPORT ‚îÄ‚îÄ */
function exportReport() {
  const answer = document.getElementById('student-answer').value || '(No answer recorded)';
  const html = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Mission Report ‚Äî 6.2 Data Formats</title>
  <style>body{font-family:monospace;background:#0D1117;color:#E8EDF3;padding:40px;max-width:800px;margin:0 auto;}
  h1{color:#38BDF8;font-size:24px;margin-bottom:4px;} .tag{font-size:11px;letter-spacing:3px;color:#39FF14;margin-bottom:24px;display:block;}
  h2{color:#38BDF8;font-size:14px;letter-spacing:2px;margin:24px 0 12px;} p{line-height:1.8;font-size:14px;}
  .ma{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:20px;margin:12px 0;}
  .n{color:#ffaaaa;} .e{color:#ffcc88;} .i{color:#aaff88;}
  .sa{background:rgba(56,189,248,0.04);border:1px solid rgba(56,189,248,0.2);border-radius:8px;padding:20px;margin:12px 0;}
  .chips{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap;}
  .chip{padding:6px 14px;border-radius:20px;font-size:12px;border:1px solid;}
  .chip-n{border-color:#FF3B3B;color:#ff8888;} .chip-e{border-color:#FF9500;color:#ffcc88;} .chip-i{border-color:#39FF14;color:#aaff88;}
  </style></head><body>
  <h1>THE MARK SCHEME METHOD¬Æ</h1>
  <span class="tag">MISSION REPORT // MODULE 6.2 // DATA FORMATS</span>
  <h2>EXAM QUESTION</h2>
  <p>A logistics company sends daily shipment updates to multiple international partners via an automated API. Explain one advantage of using JSON over XML for this data transfer. (3 Marks)</p>
  <h2>MODEL ANSWER ‚Äî 3 MARKS</h2>
  <div class="ma">
    <p><span class="n">[N] JSON (JavaScript Object Notation) is a lightweight, text-based data format that uses key-value pairs to structure data, and is the standard format for web-based API communication.</span></p>
    <p><span class="e">[E] Unlike XML, JSON does not require closing tags or a document type declaration, meaning each data packet is significantly smaller in file size and faster for receiving systems to parse.</span></p>
    <p><span class="i">[I] This reduces server processing time and bandwidth consumption, allowing the company to scale automated data exchange across hundreds of partners without proportional increases in infrastructure cost.</span></p>
  </div>
  <h2>YOUR ANSWER</h2>
  <div class="sa"><p>${answer.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</p></div>
  <h2>NEI PROFICIENCY SCAN</h2>
  <div class="chips">
    <div class="chip chip-n">${taggedN?'‚úì':'‚úó'} [N] Name ${taggedN?'DETECTED':'NOT TAGGED'}</div>
    <div class="chip chip-e">${taggedE?'‚úì':'‚úó'} [E] Explain ${taggedE?'DETECTED':'NOT TAGGED'}</div>
    <div class="chip chip-i">${taggedI?'‚úì':'‚úó'} [I] Impact ${taggedI?'DETECTED':'NOT TAGGED'}</div>
  </div>
  <p style="margin-top:32px;font-size:11px;color:rgba(232,237,243,0.3);">Generated by The Mark Scheme Method¬Æ ‚Äî Module 6.2</p>
  </body></html>`;
  const blob = new Blob([html], {type:'text/html'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
  a.download = 'mission-report-62-data-formats.html'; a.click();
}
</script>
</body>
</html>
